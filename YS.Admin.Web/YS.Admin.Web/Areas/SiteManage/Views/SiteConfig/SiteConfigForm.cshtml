@{
	Layout = "~/Areas/System/Views/Shared/_FormWhite.cshtml";
}
@inject Microsoft.AspNetCore.Hosting.IWebHostEnvironment HostingEnvironment
@section header {

	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/imageupload/1.0/css/imgup.min.css"))
	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/imageupload/1.0/js/imgup.min.js"))

	@*     @BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/ueditor/ueditor.config.js"))
        @BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/ueditor/ueditor.all.js"))*@

	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/bootstrap.tagsinput/0.8.0/bootstrap-tagsinput.min.css"))
	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/bootstrap.tagsinput/0.8.0/bootstrap-tagsinput.min.js"))
	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/webuploader/webuploader.min.js"))
	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/webuploader/uploader2.js"))
	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/webuploader/common.js"))
	@BundlerHelper.Render(HostingEnvironment.ContentRootPath, Url.Content("~/lib/webuploader/style.css"))
}

<script>
	$(function () {
		$(".upload-pdf-file").each(function () {
			$(this).InitUploader({
				filesize: '512000',
				sendurl: '/File/UploadFile?fileModule=@UploadFileType.Apk.ParseToInt()',
				swf: '@Url.Content("~/lib/webuploader/uploader.swf")',
				filetypes: 'apk',

			});
		});

	});
</script>
<div class="wrapper animated fadeInRight">
	<form id="form" class="form-horizontal m">
		<div class="form-group">

			<input id="id" col="Id" type="hidden" class="form-control" />
			<label class="col-sm-2 control-label ">网站名称<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webName" col="WebName" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">联系人<font class="red"> *</font></label>
			<div class="col-sm-4">
				@*<input id="webLogo" col="WebLogo" type="text" class="form-control" />*@
				<input id="webContact" col="WebContact" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">公开课单价<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="classPrices" col="ClassPrices" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">公开课描述<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="classPricesDes" col="ClassPricesDes" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">公司名称<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webCompany" col="WebCompany" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">通讯地址<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webAddress" col="WebAddress" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">电话<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webPhone" col="WebPhone" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">邮箱<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webEmail" col="WebEmail" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">网站备案号<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webCord" col="WebCord" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">版权所有<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="AllRight" col="AllRight" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">客服联系方式<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="ServiceTel" col="ServiceTel" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">公司地址<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="Addr" col="Addr" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">工作时间<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="WorkTime" col="WorkTime" type="text" class="form-control" />
			</div> 
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">首页标题(SEO)<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webTitle" col="WebTitle" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">页面描述(SEO)<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webDescription" col="WebDescription" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">网站地址<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webUrl" col="WebUrl" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">网站LOGO<font class="red"> *</font></label>
			<div class="col-sm-4">
				@*<input id="webWxQCode" col="WebWxQCode" type="text" class="form-control" />*@
				<div id="webLogo" class="img-box">
				</div>
			</div>
			<label class="col-sm-2 control-label ">微信二维码<font class="red"> *</font></label>
			<div class="col-sm-4">
				<div id="webWxQCode" class="img-box">
				</div>
			</div>
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">联系电话<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webTel" col="WebTel" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">邮编<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webPost" col="WebPost" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">传真<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webFax" col="WebFax" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">京公网安备<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webPolice" col="WebPolice" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group" style="display:none;">
			<label class="col-sm-2 control-label ">页面关健词(SEO)<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webKeyword" col="WebKeyword" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">网站版权信息<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="webCopyRight" col="WebCopyRight" type="text" class="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">APK版本<font class="red"> *</font></label>
			<div class="col-sm-3">
				<input id="apkVersion" col="ApkVersion" type="text" class="form-control" />
			</div>
			<label class="col-sm-2 control-label ">APK升级文件<font class="red"> *</font></label>
			<div class="col-sm-4">
				<input id="apkFilePath" col="ApkFilePath" type="text" class="form-control  upload-path" />
			</div>
			<div class="upload-box upload-pdf-file"></div>
		</div>
		<div class="form-group">
			<label class="col-sm-2 control-label ">文档横幅<font class="red"> *</font></label>
			<div class="col-sm-3">
				<div id="imgUrl" class="img-box">
				</div>
			</div>
			<label class="col-sm-2 control-label ">最新消息横幅<font class="red"> *</font></label>
			<div class="col-sm-4">
				<div id="imgUrl2" class="img-box">
				</div>
			</div>
			<div class="upload-box upload-pdf-file"></div>
		</div>
		@*<h4 class="form-header h4">操作</h4>*@
		<div class="row">
			<div class="col-sm-offset-5 col-sm-10">
				<button type="button" class="btn btn-sm btn-primary" onclick="saveForm()"><i class="fa fa-check"></i>保 存</button>
			</div>
		</div>

	</form>
</div>

<script type="text/javascript">
	var id = ys.request("id");
	$(function () {
		$("#webLogo").imageUpload({ uploadImage: 'uploadThumbImage', limit: 1, context: ctx });
		$("#webWxQCode").imageUpload({ uploadImage: 'uploadThumbImage', limit: 1, context: ctx });
		$("#imgUrl").imageUpload({ uploadImage: 'uploadThumbImage', limit: 1, context: ctx });
		$("#imgUrl2").imageUpload({ uploadImage: 'uploadThumbImage', limit: 1, context: ctx });
		getForm();

		$('#form').validate({
			rules: {
				webName: { required: true }
			}
		});
	});

	function getForm() {
		//if (id > 0) {
		ys.ajax({
			url: '@Url.Content("~/SiteManage/SiteConfig/GetDefaultFormJson")',
			type: 'get',
			success: function (obj) {
				if (obj.Tag == 1) {
					$("#webLogo").imageUpload("setImageUrl", obj.Data.WebLogo);
					$("#imgUrl").imageUpload("setImageUrl", obj.Data.ImgUrl);
					$("#imgUrl2").imageUpload("setImageUrl", obj.Data.ImgUrl2);
					$("#webWxQCode").imageUpload("setImageUrl", obj.Data.WebWxQCode);
					$('#form').setWebControls(obj.Data);
				}
			}
		});
		//}
		//else {
		//    var defaultData = {};
		//    $('#form').setWebControls(defaultData);
		//}
	}

	function saveForm() {
		if ($('#form').validate().form()) {
			var postData = $('#form').getWebControls({ Id: id });
			postData.WebLogo = $("#webLogo").imageUpload("getImageUrl");
			postData.WebWxQCode = $("#webWxQCode").imageUpload("getImageUrl");
			postData.ImgUrl = $("#imgUrl").imageUpload("getImageUrl");
			postData.ImgUrl2 = $("#imgUrl2").imageUpload("getImageUrl");
			ys.ajax({
				url: '@Url.Content("~/SiteManage/SiteConfig/SaveFormJson")',
				type: 'post',
				data: postData,
				success: function (obj) {
					if (obj.Tag == 1) {
						ys.msgSuccess(obj.Message);
					}
					else {
						ys.msgError(obj.Message);
					}
				}
			});
		}
	}


	function uploadThumbImage(file, callback) {
		var formdata = new FormData();
		formdata.append("fileList", file[0]);
		ys.ajaxUploadFile({
			url: '/File/UploadFile?fileModule=@UploadFileType.News.ParseToInt()',
			data: formdata,
			success: function (obj) {
				if (obj.Tag == 1) {
					if (callback) {
						//callback('@GlobalContext.SystemConfig.ApiSite' + obj.Data);
						callback(obj.Data);
					}
				}
				else {
					ys.msgError(obj.Message);
				}
			}
		})
	}
</script>

